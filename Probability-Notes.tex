\documentclass[device=normal, lang=en]{elegantbook}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{float}
\usepackage{extarrows}
\usepackage{physics}
\usepackage{mathtools}

\input{math_cmds.tex}

\definecolor{pgcolor}{RGB}{251, 250, 248}
\pagecolor{pgcolor}
\numberwithin{equation}{section}

% \theoremstyle{definition} %
% \newtheorem{property}{Property}[section] %

\title{Probability Notes}
\author{FHYQ-Dong}
\date{\today}
\version{12.0}
\cover{images/Note-cover.png}
\definecolor{customcoverlinecolor}{RGB}{82, 59, 148}
\colorlet{coverlinecolor}{customcoverlinecolor}


\begin{document}

\maketitle
\frontmatter

\tableofcontents
\mainmatter


\input{chaps/chap_Probability_Space.tex}
\input{chaps/chap_Conditional_Probability.tex}
\input{chaps/chap_Independence.tex}
\input{chaps/chap_Discrete_Random_Variables.tex}
\input{chaps/chap_Multiple_Random_Variables.tex}
\input{chaps/chap_Continuous_Random_Variables.tex}
\input{chaps/chap_Multiple_Continuous_Random_Variables.tex}
\input{chaps/chap_Derived_Distributions_and_Entropy.tex}
\input{chaps/chap_Convolution_Covariance_Correlation_and_Conditional_Expectation.tex}
\input{chaps/chap_Transforms_and_Sum_of_A_Random_Number_of_RVs.tex}
\input{chaps/chap_Weak_Law_of_Large_Numbers.tex}


\chapter{Central Limit Theorem}

\section{Central Limit Theorem}
Let $X_1, X_2, \ldots, X_n$ be i.i.d. RVs with finite mean $\mu$ and finite variance $\sigma^2$. Standardize the sum $S_n = X_1 + X_2 + \cdots + X_n$ by
\begin{equation}
    Z_n = \frac{S_n - \E[S_n]}{\sqrt{\var(S_n)}} = \frac{S_n - n\mu}{\sqrt{n}\sigma}
\end{equation}
then $\E[Z_n] = 0$ and $\var(Z_n) = 1$. 

\begin{theorem}[Central Limit Theorem]
    Let $X_1, X_2, \ldots, X_n$ be i.i.d. RVs with finite mean $\mu$ and finite variance $\sigma^2$. Then the distribution of $Z_n$ converges to the standard normal distribution as $n \to \infty$, i.e.
    \begin{equation}
        Z_n \xrightarrow{D} N(0, 1)
    \end{equation}
    or equivalently
    \begin{equation}
        \frac{S_n - n\mu}{\sqrt{n}\sigma} \xrightarrow{D} N(0, 1)
    \end{equation}
\end{theorem}
\begin{proof}
    For simplicity, assume $X_1, X_2, \ldots, X_n$ are i.i.d. RVs with mean $\mu = 0$, variance $\sigma^2$ and transform $M_X(s)$. The transform of $Z_n$ is 
    \begin{equation}
        M_{Z_n}(s) = \E[\e^{sZ_n}] = \E\qty[\e^{\frac{s}{\sqrt{n}\sigma}S_n}] = \prod_{i=1}^{n} M_X\qty(\frac{s}{\sqrt{n}\sigma}) = \qty(M_X\qty(\frac{s}{\sqrt{n}\sigma}))^n
    \end{equation}
    By the Taylor expansion of $M_X(s)$ around $s = 0$
    \begin{equation}
        M_X\qty(\frac{s}{\sqrt{n}\sigma}) = 1 + \frac{s^2}{2n} + o\qty(\frac{s^2}{n\sigma^2}), \quad \text{as } n \to \infty
    \end{equation}
    Therefore
    \begin{equation}
        M_{Z_n}(s) = \qty(1 + \frac{s^2}{2n} + o\qty(\frac{s^2}{n\sigma^2}))^n \xrightarrow{n \to \infty} \e^{\frac{s^2}{2}} = M_{N(0, 1)}(s)
    \end{equation}
\end{proof}

\begin{example}[The Pollster's problem]
    Let $f$ denote the fraction of the entire voter population, $X_i$ be the indicator RV that the $i$-th voter polls, and $M_n = (X_1 + \cdots + X_n) / n$. Find $n$ such that
    \begin{equation}
        \mathbf{P}(\abs{M_n - f} \geq 0.01) \leq 0.05
    \end{equation}
\end{example}
\begin{solution}
    \begin{equation}
        \abs{M_n - f} \geq 0.01 \quad\Leftrightarrow\quad \abs{\frac{X_1 + \cdots + X_n - nf}{\sqrt{n}\sigma}} \geq \frac{0.01 \sqrt{n}}{\sigma}
    \end{equation}
    where LHS follows a standard normal distribution. Let $Z \sim N(0, 1)$, then
    \begin{equation}
        \mathbf{P}(\abs{M_n - f} \geq 0.01) \approx \mathbf{P}\qty(\abs{Z} \geq \frac{0.01 \sqrt{n}}{\sigma}) \leq \mathbf{P}(\abs{Z} \geq 0.02\sqrt{n}) = 2(1 - \Phi(0.02\sqrt{n})) \leq 0.05
    \end{equation}
    which yields $n \geq 9604$.
\end{solution}

\begin{example}[Binomial RV]
    A binomial RV $S_n$ with parameters $n$ and $p$ can be viewed as the sum of $n$ independent Bernoulli RVs $X_1, \ldots, X_n$ with parameter $p$
    \begin{equation}
        S_n = X_1 + X_2 + \cdots + X_n
    \end{equation}
    Find $\mathbf{P}(k \leq S_n \leq l)$.
\end{example}
\begin{solution}
    For Bernoulli RV $X_i$
    \begin{equation}
        \mu = \E[X_i] = p, \quad \sigma = \sqrt{\var(X_i)} = \sqrt{p(1-p)}
    \end{equation}
    and the inequality suggests
    \begin{equation}
        k \leq S_n \leq l \quad\Rightarrow\quad \frac{k - nq}{\sqrt{np(1-p)}} \leq Z_n \leq \frac{l - nq}{\sqrt{np(1-p)}}
    \end{equation}
    According to the CLT,$Z_n$ approximately follows a standard normal distribution, therefore
    \begin{equation}
        \mathbf{P}(k \leq S_n \leq l) = \mathbf{P}\qty(\frac{k - np}{\sqrt{np(1-p)}} \leq Z_n \leq \frac{l - np}{\sqrt{np(1-p)}}) \approx \Phi\qty(\frac{l - np}{\sqrt{np(1-p)}}) - \Phi\qty(\frac{k - np}{\sqrt{np(1-p)}})
    \end{equation}
    which is known as the De Moivre-Laplace Approximation to the Binomial distribution.
\end{solution}
\begin{theorem}[De Moivre-Laplace Approximation to the Binomial Distribution]
    If $S_n$ is a binomial RV with parameters $n$ and $p$, with $n$ large and $k, l$ nonnegative integers, then
    \begin{equation}
        \mathbf{P}(k \leq S_n \leq l) \approx \Phi\qty(\frac{l - np}{\sqrt{np(1-p)}}) - \Phi\qty(\frac{k - np}{\sqrt{np(1-p)}})
    \end{equation}
\end{theorem}
\begin{example}[Approximation to the Binomial CDF]
    Given $n = 36$ and $p = 0.5$, find $\mathbf{P}(S_n \leq 21)$.
\end{example}
\begin{solution}
    An exact calculation gives
    \begin{equation}
        \mathbf{P}(S_n \leq 21) = \sum_{k=0}^{21} \binom{36}{k} (0.5)^{36} = 0.8785
    \end{equation}
    The CLT gives
    \begin{equation}
        \mathbf{P}(S_n \leq 21) \approx \Phi\qty(\frac{21 - 18}{\sqrt{9}}) = 0.8413
    \end{equation}
\end{solution}

The approximation seems simple and useful, but notice that $S_n$ is always an integer while $\Phi$ is continuous, so $\mathbf{P}(S_n \leq k) = \mathbf{P}(S_n < k + 1)$. Usually, we use the 1/2 correction to do approximation (not only for the binomial distribution).
\begin{example}[Approximation to the Binomial PMF]
    When the 1/2 correction is used, use the CLT to approximate $\mathbf{P}(S_n \leq 19)$, where $S_n$ is a binomial RV with parameters $n = 36$ and $p = 0.5$.
\end{example}
\begin{solution}
    \begin{equation}
        \mathbf{P}(S_n = 19) = \mathbf{P}(18.5 \leq S_n \leq 19.5) \approx \Phi\qty(\frac{19.5 - 18}{3}) - \Phi\qty(\frac{18.5 - 18}{3}) = 0.124
    \end{equation}
    The exact value is
    \begin{equation}
        \mathbf{P}(S_n = 19) = \binom{36}{19} (0.5)^{36} = 0.1251
    \end{equation}
\end{solution}

\appendix
\input{chaps/app_Problem_Solutions.tex}


\end{document}
